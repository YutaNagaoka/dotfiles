- name: Update apt
  apt:
    update_cache: yes
    upgrade: "yes"
  become: yes

- name: Install tools via apt
  apt:
    pkg:
    - bison
    - build-essential
    - curl
    - file
    - gdb
    - jq
    - libssl-dev
    - ltrace
    - strace
    - vim
    - wget
    - zsh
  become: yes

- name: Install rustup
  shell:
    cmd: |
      curl -sSf https://sh.rustup.rs | sh -s -- -y
    creates: |
      "{{ ansible_env.HOME }}/.cargo"
      "{{ ansible_env.HOME }}/.rustup"

- name: Install Starship
  shell:
    cmd: curl -fsSL https://starship.rs/install.sh | bash -s -- -y

- name: Install node
  shell:
    cmd: |
      curl -L https://git.io/n-install | bash -s -- -y
      npm install -g yarn

# - name: Install yarn
#   npm:
#     name: yarn
#     global: yes

- name: Install go
  import_role:
    name: golang

- name: Install ghq
  shell:
    cmd: go get github.com/x-motemen/ghq

- name: Install fzf
  shell:
    cmd: |
      git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
      {{ ansible_env.HOME }}/.fzf/install
    creates: "{{ ansible_env.HOME }}.fzf"

- name: Install zinit
  shell:
    cmd: sh -c "$(curl -fsSL https://raw.githubusercontent.com/zdharma/zinit/master/doc/install.sh)"
    creates: "{{ ansible_env.HOME }}.zinit"

- name: Install Neovim
  shell:
    cmd: |
      curl -LO https://github.com/neovim/neovim/releases/download/stable/nvim.appimage
      chmod u+x nvim.appimage
      mv nvim.appimage /usr/local/bin/nvim
      curl https://raw.githubusercontent.com/Shougo/dein.vim/master/bin/installer.sh > installer.sh
      sh ./installer.sh ~/.cache/dein
